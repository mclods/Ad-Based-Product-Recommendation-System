from flask import Flask, render_template, url_for, request, jsonify, make_response, flash, redirect
from flask_sqlalchemy import sqlalchemy
from recommendation import laptop_recommendation
from forms import RegistrationForm, LoginForm
from return_dict import return_data
from product_recommend import product_recommendation

app = Flask(__name__)
app.config['SECRET_KEY'] = '4abf11146c3423ef684b33eea2aaaf24'

rec_list = None
req = None

lap_data = [{'index': 0, 'company': 'Apple', 'product': 'MacBook Pro', 'type': 'Ultrabook', 'screen_size': 13.3, 'resolution': 'IPS Panel Retina Display 2560x1600', 'cpu': 'Intel Core i5 2.3GHz', 'ram': '8GB', 'memory': '128GB SSD', 'gpu': 'Intel Iris Plus Graphics 640', 'op': 'macOS', 'weight': '1.37kg', 'price': 1339.69}, {'index': 1, 'company': 'Apple', 'product': 'Macbook Air', 'type': 'Ultrabook', 'screen_size': 13.3, 'resolution': '1440x900', 'cpu': 'Intel Core i5 1.8GHz', 'ram': '8GB', 'memory': '128GB Flash Storage', 'gpu': 'Intel HD Graphics 6000', 'op': 'macOS', 'weight': '1.34kg', 'price': 898.94}, {'index': 2, 'company': 'HP', 'product': '250 G6', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': 'Full HD 1920x1080', 'cpu': 'Intel Core i5 7200U 2.5GHz', 'ram': '8GB', 'memory': '256GB SSD', 'gpu': 'Intel HD Graphics 620', 'op': 'No OS', 'weight': '1.86kg', 'price': 575.0}, {'index': 3, 'company': 'Apple', 'product': 'MacBook Pro', 'type': 'Ultrabook', 'screen_size': 15.4, 'resolution': 'IPS Panel Retina Display 2880x1800', 'cpu': 'Intel Core i7 2.7GHz', 'ram': '16GB', 'memory': '512GB SSD', 'gpu': 'AMD Radeon Pro 455', 'op': 'macOS', 'weight': '1.83kg', 'price': 2537.45}, {'index': 4, 'company': 'Apple', 'product': 'MacBook Pro', 'type': 'Ultrabook', 'screen_size': 13.3, 'resolution': 'IPS Panel Retina Display 2560x1600', 'cpu': 'Intel Core i5 3.1GHz', 'ram': '8GB', 'memory': '256GB SSD', 'gpu': 'Intel Iris Plus Graphics 650', 'op': 'macOS', 'weight': '1.37kg', 'price': 1803.6}, {'index': 5, 'company': 'Acer', 'product': 'Aspire 3', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': '1366x768', 'cpu': 'AMD A9-Series 9420 3GHz', 'ram': '4GB', 'memory': '500GB HDD', 'gpu': 'AMD Radeon R5', 'op': 'Windows 10', 'weight': '2.1kg', 'price': 400.0}, {'index': 6, 'company': 'Apple', 'product': 'MacBook Pro', 'type': 'Ultrabook', 'screen_size': 15.4, 'resolution': 'IPS Panel Retina Display 2880x1800', 'cpu': 'Intel Core i7 2.2GHz', 'ram': '16GB', 'memory': '256GB Flash Storage', 'gpu': 'Intel Iris Pro Graphics', 'op': 'Mac OS X', 'weight': '2.04kg', 'price': 2139.97}, {'index': 7, 'company': 'Apple', 'product': 'Macbook Air', 'type': 'Ultrabook', 'screen_size': 13.3, 'resolution': '1440x900', 'cpu': 'Intel Core i5 1.8GHz', 'ram': '8GB', 'memory': '256GB Flash Storage', 'gpu': 'Intel HD Graphics 6000', 'op': 'macOS', 'weight': '1.34kg', 'price': 1158.7}, {'index': 8, 'company': 'Asus', 'product': 'ZenBook UX430UN', 'type': 'Ultrabook', 'screen_size': 14.0, 'resolution': 'Full HD 1920x1080', 'cpu': 'Intel Core i7 8550U 1.8GHz', 'ram': '16GB', 'memory': '512GB SSD', 'gpu': 'Nvidia GeForce MX150', 'op': 'Windows 10', 'weight': '1.3kg', 'price': 1495.0}, {'index': 9, 'company': 'Acer', 'product': 'Swift 3', 'type': 'Ultrabook', 'screen_size': 14.0, 'resolution': 'IPS Panel Full HD 1920x1080', 'cpu': 'Intel Core i5 8250U 1.6GHz', 'ram': '8GB', 'memory': '256GB SSD', 'gpu': 'Intel UHD Graphics 620', 'op': 'Windows 10', 'weight': '1.6kg', 'price': 770.0}, {'index': 10, 'company': 'HP', 'product': '250 G6', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': '1366x768', 'cpu': 'Intel Core i5 7200U 2.5GHz', 'ram': '4GB', 'memory': '500GB HDD', 'gpu': 'Intel HD Graphics 620', 'op': 'No OS', 'weight': '1.86kg', 'price': 393.9}, {'index': 11, 'company': 'HP', 'product': '250 G6', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': 'Full HD 1920x1080', 'cpu': 'Intel Core i3 6006U 2GHz', 'ram': '4GB', 'memory': '500GB HDD', 'gpu': 'Intel HD Graphics 520', 'op': 'No OS', 'weight': '1.86kg', 'price': 344.99}, {'index': 12, 'company': 'Apple', 'product': 'MacBook Pro', 'type': 'Ultrabook', 'screen_size': 15.4, 'resolution': 'IPS Panel Retina Display 2880x1800', 'cpu': 'Intel Core i7 2.8GHz', 'ram': '16GB', 'memory': '256GB SSD', 'gpu': 'AMD Radeon Pro 555', 'op': 'macOS', 'weight': '1.83kg', 'price': 2439.97}, {'index': 14, 'company': 'Apple', 'product': 'MacBook 12"', 'type': 'Ultrabook', 'screen_size': 12.0, 'resolution': 'IPS Panel Retina Display 2304x1440', 'cpu': 'Intel Core M m3 1.2GHz', 'ram': '8GB', 'memory': '256GB SSD', 'gpu': 'Intel HD Graphics 615', 'op': 'macOS', 'weight': '0.92kg', 'price': 1262.4}, {'index': 15, 'company': 'Apple', 'product': 'MacBook Pro', 'type': 'Ultrabook', 'screen_size': 13.3, 'resolution': 'IPS Panel Retina Display 2560x1600', 'cpu': 'Intel Core i5 2.3GHz', 'ram': '8GB', 'memory': '256GB SSD', 'gpu': 'Intel Iris Plus Graphics 640', 'op': 'macOS', 'weight': '1.37kg', 'price': 1518.55}, {'index': 17, 'company': 'Apple', 'product': 'MacBook Pro', 'type': 'Ultrabook', 'screen_size': 15.4, 'resolution': 'IPS Panel Retina Display 2880x1800', 'cpu': 'Intel Core i7 2.9GHz', 'ram': '16GB', 'memory': '512GB SSD', 'gpu': 'AMD Radeon Pro 560', 'op': 'macOS', 'weight': '1.83kg', 'price': 2858.0}, {'index': 18, 'company': 'Lenovo', 'product': 'IdeaPad 320-15IKB', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': 'Full HD 1920x1080', 'cpu': 'Intel Core i3 7100U 2.4GHz', 'ram': '8GB', 'memory': '1TB HDD', 'gpu': 'Nvidia GeForce 940MX', 'op': 'No OS', 'weight': '2.2kg', 'price': 499.0}, {'index': 20, 'company': 'Asus', 'product': 'Vivobook E200HA', 'type': 'Netbook', 'screen_size': 11.6, 'resolution': '1366x768', 'cpu': 'Intel Atom x5-Z8350 1.44GHz', 'ram': '2GB', 'memory': '32GB Flash Storage', 'gpu': 'Intel HD Graphics 400', 'op': 'Windows 10', 'weight': '0.98kg', 'price': 191.9}, {'index': 21, 'company': 'Lenovo', 'product': 'Legion Y520-15IKBN', 'type': 'Gaming', 'screen_size': 15.6, 'resolution': 'IPS Panel Full HD 1920x1080', 'cpu': 'Intel Core i5 7300HQ 2.5GHz', 'ram': '8GB', 'memory': '128GB SSD +  1TB HDD', 'gpu': 'Nvidia GeForce GTX 1050', 'op': 'Windows 10', 'weight': '2.5kg', 'price': 999.0}, {'index': 22, 'company': 'HP', 'product': '255 G6', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': '1366x768', 'cpu': 'AMD E-Series E2-9000e 1.5GHz', 'ram': '4GB', 'memory': '500GB HDD', 'gpu': 'AMD Radeon R2', 'op': 'No OS', 'weight': '1.86kg', 'price': 258.0}, {'index': 24, 'company': 'HP', 'product': '15-BS101nv (i7-8550U/8GB/256GB/FHD/W10)', 'type': 'Ultrabook', 'screen_size': 15.6, 'resolution': 'Full HD 1920x1080', 'cpu': 'Intel Core i7 8550U 1.8GHz', 'ram': '8GB', 'memory': '256GB SSD', 'gpu': 'Intel HD Graphics 620', 'op': 'Windows 10', 'weight': '1.91kg', 'price': 659.0}, {'index': 26, 'company': 'Apple', 'product': 'MacBook Air', 'type': 'Ultrabook', 'screen_size': 13.3, 'resolution': '1440x900', 'cpu': 'Intel Core i5 1.6GHz', 'ram': '8GB', 'memory': '128GB Flash Storage', 'gpu': 'Intel HD Graphics 6000', 'op': 'Mac OS X', 'weight': '1.35kg', 'price': 1099.0}, {'index': 29, 'company': 'HP', 'product': 'ProBook 470', 'type': 'Notebook', 'screen_size': 17.3, 'resolution': 'Full HD 1920x1080', 'cpu': 'Intel Core i5 8250U 1.6GHz', 'ram': '8GB', 'memory': '1TB HDD', 'gpu': 'Nvidia GeForce 930MX', 'op': 'Windows 10', 'weight': '2.5kg', 'price': 896.0}, {'index': 30, 'company': 'Chuwi', 'product': 'LapBook 15.6"', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': 'Full HD 1920x1080', 'cpu': 'Intel Atom x5-Z8300 1.44GHz', 'ram': '4GB', 'memory': '64GB Flash Storage', 'gpu': 'Intel HD Graphics', 'op': 'Windows 10', 'weight': '1.89kg', 'price': 244.99}, {'index': 31, 'company': 'Asus', 'product': 'E402WA-GA010T (E2-6110/2GB/32GB/W10)', 'type': 'Notebook', 'screen_size': 14.0, 'resolution': '1366x768', 'cpu': 'AMD E-Series E2-6110 1.5GHz', 'ram': '2GB', 'memory': '32GB Flash Storage', 'gpu': 'AMD Radeon R2', 'op': 'Windows 10', 'weight': '1.65kg', 'price': 199.0}, {'index': 32, 'company': 'HP', 'product': '17-ak001nv (A6-9220/4GB/500GB/Radeon', 'type': 'Notebook', 'screen_size': 17.3, 'resolution': 'Full HD 1920x1080', 'cpu': 'AMD A6-Series 9220 2.5GHz', 'ram': '4GB', 'memory': '500GB HDD', 'gpu': 'AMD Radeon 530', 'op': 'Windows 10', 'weight': '2.71kg', 'price': 439.0}, {'index': 34, 'company': 'Apple', 'product': 'MacBook Air', 'type': 'Ultrabook', 'screen_size': 13.3, 'resolution': '1440x900', 'cpu': 'Intel Core i5 1.6GHz', 'ram': '8GB', 'memory': '256GB Flash Storage', 'gpu': 'Intel HD Graphics 6000', 'op': 'Mac OS X', 'weight': '1.35kg', 'price': 998.0}, {'index': 35, 'company': 'Lenovo', 'product': 'IdeaPad 120S-14IAP', 'type': 'Notebook', 'screen_size': 14.0, 'resolution': '1366x768', 'cpu': 'Intel Celeron Dual Core N3350 1.1GHz', 'ram': '4GB', 'memory': '64GB Flash Storage', 'gpu': 'Intel HD Graphics 500', 'op': 'Windows 10', 'weight': '1.44kg', 'price': 249.0}, {'index': 36, 'company': 'Acer', 'product': 'Aspire 3', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': '1366x768', 'cpu': 'Intel Core i3 7130U 2.7GHz', 'ram': '4GB', 'memory': '1TB HDD', 'gpu': 'Intel HD Graphics 620', 'op': 'Linux', 'weight': '2.1kg', 'price': 367.0}, {'index': 38, 'company': 'HP', 'product': '250 G6', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': '1366x768', 'cpu': 'Intel Core i5 7200U 2.5GHz', 'ram': '4GB', 'memory': '1TB HDD', 'gpu': 'Intel HD Graphics 620', 'op': 'Windows 10', 'weight': '1.86kg', 'price': 488.69}, {'index': 39, 'company': 'HP', 'product': 'ProBook 450', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': 'Full HD 1920x1080', 'cpu': 'Intel Core i5 8250U 1.6GHz', 'ram': '8GB', 'memory': '256GB SSD', 'gpu': 'Nvidia GeForce 930MX ', 'op': 'Windows 10', 'weight': '2.1kg', 'price': 879.0}, {'index': 40, 'company': 'Asus', 'product': 'X540UA-DM186 (i3-6006U/4GB/1TB/FHD/Linux)', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': 'Full HD 1920x1080', 'cpu': 'Intel Core i3 6006U 2GHz', 'ram': '4GB', 'memory': '1TB HDD', 'gpu': 'Intel HD Graphics 620', 'op': 'Linux', 'weight': '2kg', 'price': 389.0}, {'index': 42, 'company': 'Asus', 'product': 'X542UQ-GO005 (i5-7200U/8GB/1TB/GeForce', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': '1366x768', 'cpu': 'Intel Core i5 7200U 2.5GHz', 'ram': '8GB', 'memory': '1TB HDD', 'gpu': 'Nvidia GeForce 940MX', 'op': 'Linux', 'weight': '2.3kg', 'price': 522.99}, {'index': 43, 'company': 'Acer', 'product': 'Aspire A515-51G', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': 'IPS Panel Full HD 1920x1080', 'cpu': 'Intel Core i5 8250U 1.6GHz', 'ram': '4GB', 'memory': '256GB SSD', 'gpu': 'Intel UHD Graphics 620', 'op': 'Windows 10', 'weight': '2.2kg', 'price': 682.0}, {'index': 45, 'company': 'Apple', 'product': 'MacBook Pro', 'type': 'Ultrabook', 'screen_size': 13.3, 'resolution': 'IPS Panel Retina Display 2560x1600', 'cpu': 'Intel Core i5 2.0GHz', 'ram': '8GB', 'memory': '256GB SSD', 'gpu': 'Intel Iris Graphics 540', 'op': 'macOS', 'weight': '1.37kg', 'price': 1419.0}, {'index': 46, 'company': 'Lenovo', 'product': 'IdeaPad 320-15ISK', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': '1366x768', 'cpu': 'Intel Core i3 6006U 2GHz', 'ram': '4GB', 'memory': '128GB SSD', 'gpu': 'Intel HD Graphics 520', 'op': 'No OS', 'weight': '2.2kg', 'price': 369.0}, {'index': 47, 'company': 'Asus', 'product': 'Rog Strix', 'type': 'Gaming', 'screen_size': 17.3, 'resolution': 'Full HD 1920x1080', 'cpu': 'AMD Ryzen 1700 3GHz', 'ram': '8GB', 'memory': '256GB SSD +  1TB HDD', 'gpu': 'AMD Radeon RX 580', 'op': 'Windows 10', 'weight': '3.2kg', 'price': 1299.0}, {'index': 49, 'company': 'Asus', 'product': 'X751NV-TY001T (N4200/4GB/1TB/GeForce', 'type': 'Notebook', 'screen_size': 17.3, 'resolution': '1366x768', 'cpu': 'Intel Pentium Quad Core N4200 1.1GHz', 'ram': '4GB', 'memory': '1TB HDD', 'gpu': 'Nvidia GeForce 920MX', 'op': 'Windows 10', 'weight': '2.8kg', 'price': 466.0}, {'index': 50, 'company': 'Lenovo', 'product': 'Yoga Book', 'type': '2 in 1 Convertible', 'screen_size': 10.1, 'resolution': 'IPS Panel Touchscreen 1920x1200', 'cpu': 'Intel Atom x5-Z8550 1.44GHz', 'ram': '4GB', 'memory': '64GB Flash Storage', 'gpu': 'Intel HD Graphics 400', 'op': 'Android', 'weight': '0.69kg', 'price': 319.0}, {'index': 51, 'company': 'Acer', 'product': 'Aspire A515-51G', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': 'IPS Panel Full HD 1920x1080', 'cpu': 'Intel Core i7 8550U 1.8GHz', 'ram': '8GB', 'memory': '256GB SSD', 'gpu': 'Nvidia GeForce MX150', 'op': 'Windows 10', 'weight': '2.2kg', 'price': 841.0}, {'index': 52, 'company': 'HP', 'product': '255 G6', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': 'Full HD 1920x1080', 'cpu': 'AMD A6-Series 9220 2.5GHz', 'ram': '4GB', 'memory': '256GB SSD', 'gpu': 'AMD Radeon R4 Graphics', 'op': 'Windows 10', 'weight': '1.86kg', 'price': 398.49}, {'index': 53, 'company': 'HP', 'product': 'ProBook 430', 'type': 'Notebook', 'screen_size': 13.3, 'resolution': 'Full HD 1920x1080', 'cpu': 'Intel Core i7 8550U 1.8GHz', 'ram': '8GB', 'memory': '512GB SSD', 'gpu': 'Intel UHD Graphics 620', 'op': 'Windows 10', 'weight': '1.49kg', 'price': 1103.0}, {'index': 54, 'company': 'Acer', 'product': 'Aspire 3', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': '1366x768', 'cpu': 'Intel Core i3 7100U 2.4GHz', 'ram': '4GB', 'memory': '1TB HDD', 'gpu': 'Intel HD Graphics 620', 'op': 'Windows 10', 'weight': '2.4kg', 'price': 384.0}, {'index': 56, 'company': 'HP', 'product': '15-bs002nv (i3-6006U/4GB/128GB/FHD/W10)', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': 'Full HD 1920x1080', 'cpu': 'Intel Core i3 6006U 2GHz', 'ram': '4GB', 'memory': '128GB SSD', 'gpu': 'Intel HD Graphics 520', 'op': 'Windows 10', 'weight': '1.91kg', 'price': 439.0}, {'index': 57, 'company': 'Asus', 'product': 'VivoBook Max', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': '1366x768', 'cpu': 'Intel Core i5 7200U 2.5GHz', 'ram': '4GB', 'memory': '256GB SSD', 'gpu': 'Intel HD Graphics 620', 'op': 'Windows 10', 'weight': '2kg', 'price': 586.19}, {'index': 58, 'company': 'MSI', 'product': 'GS73VR 7RG', 'type': 'Gaming', 'screen_size': 17.3, 'resolution': 'Full HD 1920x1080', 'cpu': 'Intel Core i7 7700HQ 2.8GHz', 'ram': '16GB', 'memory': '256GB SSD +  2TB HDD', 'gpu': 'Nvidia GeForce GTX 1070', 'op': 'Windows 10', 'weight': '2.43kg', 'price': 2449.0}, {'index': 59, 'company': 'Asus', 'product': 'X541UA-DM1897 (i3-6006U/4GB/256GB/FHD/Linux)', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': 'Full HD 1920x1080', 'cpu': 'Intel Core i3 6006U 2GHz', 'ram': '4GB', 'memory': '256GB SSD', 'gpu': 'Intel HD Graphics 520', 'op': 'Linux', 'weight': '2kg', 'price': 415.0}, {'index': 62, 'company': 'Lenovo', 'product': 'IdeaPad 520S-14IKB', 'type': 'Notebook', 'screen_size': 14.0, 'resolution': 'IPS Panel Full HD 1920x1080', 'cpu': 'Intel Core i3 7130U 2.7GHz', 'ram': '8GB', 'memory': '256GB SSD', 'gpu': 'Intel HD Graphics 620', 'op': 'No OS', 'weight': '1.7kg', 'price': 599.0}]
lap_data1 = [{'index': 13, 'company': 'Dell', 'product': 'Inspiron 3567', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': 'Full HD 1920x1080', 'cpu': 'Intel Core i3 6006U 2GHz', 'ram': '4GB', 'memory': '256GB SSD', 'gpu': 'AMD Radeon R5 M430', 'op': 'Windows 10', 'weight': '2.2kg', 'price': 498.9}, {'index': 16, 'company': 'Dell', 'product': 'Inspiron 3567', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': 'Full HD 1920x1080', 'cpu': 'Intel Core i7 7500U 2.7GHz', 'ram': '8GB', 'memory': '256GB SSD', 'gpu': 'AMD Radeon R5 M430', 'op': 'Windows 10', 'weight': '2.2kg', 'price': 745.0}, {'index': 19, 'company': 'Dell', 'product': 'XPS 13', 'type': 'Ultrabook', 'screen_size': 13.3, 'resolution': 'IPS Panel Full HD / Touchscreen 1920x1080', 'cpu': 'Intel Core i5 8250U 1.6GHz', 'ram': '8GB', 'memory': '128GB SSD', 'gpu': 'Intel UHD Graphics 620', 'op': 'Windows 10', 'weight': '1.22kg', 'price': 979.0}, {'index': 23, 'company': 'Dell', 'product': 'Inspiron 5379', 'type': '2 in 1 Convertible', 'screen_size': 13.3, 'resolution': 'Full HD / Touchscreen 1920x1080', 'cpu': 'Intel Core i5 8250U 1.6GHz', 'ram': '8GB', 'memory': '256GB SSD', 'gpu': 'Intel UHD Graphics 620', 'op': 'Windows 10', 'weight': '1.62kg', 'price': 819.0}, {'index': 25, 'company': 'Dell', 'product': 'Inspiron 3567', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': '1366x768', 'cpu': 'Intel Core i3 6006U 2GHz', 'ram': '4GB', 'memory': '1TB HDD', 'gpu': 'Intel HD Graphics 520', 'op': 'Windows 10', 'weight': '2.3kg', 'price': 418.64}, {'index': 27, 'company': 'Dell', 'product': 'Inspiron 5570', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': 'Full HD 1920x1080', 'cpu': 'Intel Core i5 8250U 1.6GHz', 'ram': '8GB', 'memory': '256GB SSD', 'gpu': 'AMD Radeon 530', 'op': 'Windows 10', 'weight': '2.2kg', 'price': 800.0}, {'index': 28, 'company': 'Dell', 'product': 'Latitude 5590', 'type': 'Ultrabook', 'screen_size': 15.6, 'resolution': 'Full HD 1920x1080', 'cpu': 'Intel Core i7 8650U 1.9GHz', 'ram': '8GB', 'memory': '256GB SSD +  256GB SSD', 'gpu': 'Intel UHD Graphics 620', 'op': 'Windows 10', 'weight': '1.88kg', 'price': 1298.0}, {'index': 33, 'company': 'Dell', 'product': 'XPS 13', 'type': 'Ultrabook', 'screen_size': 13.3, 'resolution': 'Touchscreen / Quad HD+ 3200x1800', 'cpu': 'Intel Core i7 8550U 1.8GHz', 'ram': '16GB', 'memory': '512GB SSD', 'gpu': 'Intel UHD Graphics 620', 'op': 'Windows 10', 'weight': '1.2kg', 'price': 1869.0}, {'index': 37, 'company': 'Dell', 'product': 'Inspiron 5770', 'type': 'Notebook', 'screen_size': 17.3, 'resolution': 'IPS Panel Full HD 1920x1080', 'cpu': 'Intel Core i5 8250U 1.6GHz', 'ram': '8GB', 'memory': '128GB SSD +  1TB HDD', 'gpu': 'AMD Radeon 530', 'op': 'Windows 10', 'weight': '2.8kg', 'price': 979.0}, {'index': 41, 'company': 'Dell', 'product': 'Inspiron 7577', 'type': 'Gaming', 'screen_size': 15.6, 'resolution': 'IPS Panel Full HD 1920x1080', 'cpu': 'Intel Core i7 7700HQ 2.8GHz', 'ram': '16GB', 'memory': '256GB SSD +  1TB HDD', 'gpu': 'Nvidia GeForce GTX 1060', 'op': 'Windows 10', 'weight': '2.65kg', 'price': 1499.0}, {'index': 44, 'company': 'Dell', 'product': 'Inspiron 7773', 'type': '2 in 1 Convertible', 'screen_size': 17.3, 'resolution': 'Full HD / Touchscreen 1920x1080', 'cpu': 'Intel Core i5 8250U 1.6GHz', 'ram': '12GB', 'memory': '1TB HDD', 'gpu': 'Nvidia GeForce 150MX', 'op': 'Windows 10', 'weight': '2.77kg', 'price': 999.0}, {'index': 48, 'company': 'Dell', 'product': 'Inspiron 3567', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': 'Full HD 1920x1080', 'cpu': 'Intel Core i5 7200U 2.5GHz', 'ram': '4GB', 'memory': '256GB SSD', 'gpu': 'AMD Radeon R5 M430', 'op': 'Windows 10', 'weight': '2.3kg', 'price': 639.0}, {'index': 55, 'company': 'Dell', 'product': 'Inspiron 3576', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': 'Full HD 1920x1080', 'cpu': 'Intel Core i7 8550U 1.8GHz', 'ram': '8GB', 'memory': '256GB SSD', 'gpu': 'AMD Radeon 520', 'op': 'Windows 10', 'weight': '2.13kg', 'price': 767.8}, {'index': 60, 'company': 'Dell', 'product': 'Inspiron 5770', 'type': 'Notebook', 'screen_size': 17.3, 'resolution': 'Full HD 1920x1080', 'cpu': 'Intel Core i7 8550U 1.8GHz', 'ram': '16GB', 'memory': '256GB SSD +  2TB HDD', 'gpu': 'AMD Radeon 530', 'op': 'Windows 10', 'weight': '2.8kg', 'price': 1299.0}, {'index': 61, 'company': 'Dell', 'product': 'Vostro 5471', 'type': 'Ultrabook', 'screen_size': 14.0, 'resolution': 'Full HD 1920x1080', 'cpu': 'Intel Core i5 8250U 1.6GHz', 'ram': '8GB', 'memory': '256GB SSD', 'gpu': 'Intel UHD Graphics 620', 'op': 'Windows 10', 'weight': '1.7kg', 'price': 879.0}, {'index': 71, 'company': 'Dell', 'product': 'Inspiron 5370', 'type': 'Ultrabook', 'screen_size': 13.3, 'resolution': 'IPS Panel Full HD 1920x1080', 'cpu': 'Intel Core i7 8550U 1.8GHz', 'ram': '8GB', 'memory': '256GB SSD', 'gpu': 'AMD Radeon 530', 'op': 'Windows 10', 'weight': '1.4kg', 'price': 955.0}, {'index': 72, 'company': 'Dell', 'product': 'Inspiron 5570', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': 'Full HD 1920x1080', 'cpu': 'Intel Core i7 8550U 1.8GHz', 'ram': '8GB', 'memory': '256GB SSD', 'gpu': 'AMD Radeon 530', 'op': 'Windows 10', 'weight': '2.2kg', 'price': 870.0}, {'index': 77, 'company': 'Dell', 'product': 'Inspiron 5570', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': 'Full HD 1920x1080', 'cpu': 'Intel Core i7 8550U 1.8GHz', 'ram': '8GB', 'memory': '128GB SSD +  1TB HDD', 'gpu': 'Intel UHD Graphics 620', 'op': 'Windows 10', 'weight': '2.02kg', 'price': 855.0}, {'index': 80, 'company': 'Dell', 'product': 'Latitude 5590', 'type': 'Ultrabook', 'screen_size': 15.6, 'resolution': 'IPS Panel Full HD 1920x1080', 'cpu': 'Intel Core i5 8250U 1.6GHz', 'ram': '8GB', 'memory': '256GB SSD', 'gpu': 'Intel UHD Graphics 620', 'op': 'Windows 10', 'weight': '1.88kg', 'price': 1096.16}, {'index': 85, 'company': 'Dell', 'product': 'Inspiron 7577', 'type': 'Gaming', 'screen_size': 15.6, 'resolution': 'IPS Panel Full HD 1920x1080', 'cpu': 'Intel Core i7 7700HQ 2.8GHz', 'ram': '16GB', 'memory': '128GB SSD +  1TB HDD', 'gpu': 'Nvidia GeForce GTX 1050 Ti', 'op': 'Windows 10', 'weight': '2.65kg', 'price': 1349.0}, {'index': 89, 'company': 'Dell', 'product': 'XPS 13', 'type': 'Ultrabook', 'screen_size': 13.3, 'resolution': 'IPS Panel Full HD 1920x1080', 'cpu': 'Intel Core i7 8550U 1.8GHz', 'ram': '8GB', 'memory': '256GB SSD', 'gpu': 'Intel UHD Graphics 620', 'op': 'Windows 10', 'weight': '1.21kg', 'price': 1649.0}, {'index': 93, 'company': 'Dell', 'product': 'Inspiron 7577', 'type': 'Gaming', 'screen_size': 15.6, 'resolution': 'Full HD 1920x1080', 'cpu': 'Intel Core i5 7300HQ 2.5GHz', 'ram': '8GB', 'memory': '256GB SSD', 'gpu': 'Nvidia GeForce GTX 1060', 'op': 'Windows 10', 'weight': '2.65kg', 'price': 1195.0}, {'index': 96, 'company': 'Dell', 'product': 'Inspiron 3567', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': 'Full HD 1920x1080', 'cpu': 'Intel Core i7 7500U 2.7GHz', 'ram': '8GB', 'memory': '1TB HDD', 'gpu': 'AMD Radeon R5 M430', 'op': 'Linux', 'weight': '2.2kg', 'price': 599.9}, {'index': 97, 'company': 'Dell', 'product': 'Inspiron 3567', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': 'Full HD 1920x1080', 'cpu': 'Intel Core i3 6006U 2GHz', 'ram': '4GB', 'memory': '256GB SSD', 'gpu': 'AMD Radeon R5 M430', 'op': 'Linux', 'weight': '2.2kg', 'price': 485.0}, {'index': 102, 'company': 'Dell', 'product': 'Inspiron 3576', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': 'Full HD 1920x1080', 'cpu': 'Intel Core i5 8250U 1.6GHz', 'ram': '8GB', 'memory': '1TB HDD', 'gpu': 'AMD Radeon 520', 'op': 'Linux', 'weight': '2.2kg', 'price': 647.0}, {'index': 111, 'company': 'Dell', 'product': 'XPS 13', 'type': 'Ultrabook', 'screen_size': 13.3, 'resolution': 'Quad HD+ / Touchscreen 3200x1800', 'cpu': 'Intel Core i7 7560U 2.4GHz', 'ram': '8GB', 'memory': '256GB SSD', 'gpu': 'Intel Iris Plus Graphics 640', 'op': 'Windows 10', 'weight': '1.23kg', 'price': 1379.0}, {'index': 114, 'company': 'Dell', 'product': 'XPS 13', 'type': 'Ultrabook', 'screen_size': 13.3, 'resolution': 'IPS Panel Full HD 1920x1080', 'cpu': 'Intel Core i5 8250U 1.6GHz', 'ram': '8GB', 'memory': '256GB SSD', 'gpu': 'Intel UHD Graphics 620', 'op': 'Windows 10', 'weight': '1.21kg', 'price': 1629.0}, {'index': 117, 'company': 'Dell', 'product': 'Inspiron 7570', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': 'IPS Panel Full HD 1920x1080', 'cpu': 'Intel Core i7 8550U 1.8GHz', 'ram': '8GB', 'memory': '256GB SSD +  1TB HDD', 'gpu': 'Nvidia GeForce 940MX', 'op': 'Windows 10', 'weight': '2.16kg', 'price': 1130.33}, {'index': 128, 'company': 'Dell', 'product': 'Inspiron 5770', 'type': 'Notebook', 'screen_size': 17.3, 'resolution': 'Full HD 1920x1080', 'cpu': 'Intel Core i7 8550U 1.8GHz', 'ram': '16GB', 'memory': '256GB SSD +  2TB HDD', 'gpu': 'AMD Radeon 530', 'op': 'Windows 10', 'weight': '2.8kg', 'price': 1396.0}, {'index': 130, 'company': 'Dell', 'product': 'Inspiron 5567', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': '1366x768', 'cpu': 'Intel Core i5 7200U 2.5GHz', 'ram': '8GB', 'memory': '1TB HDD', 'gpu': 'AMD Radeon R7 M445', 'op': 'Windows 10', 'weight': '2.36kg', 'price': 638.99}, {'index': 131, 'company': 'Dell', 'product': 'Inspiron 3567', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': 'Full HD 1920x1080', 'cpu': 'Intel Core i3 6006U 2GHz', 'ram': '4GB', 'memory': '1TB HDD', 'gpu': 'AMD Radeon R5 M430', 'op': 'Windows 10', 'weight': '2.2kg', 'price': 449.0}, {'index': 150, 'company': 'Dell', 'product': 'Inspiron 5577', 'type': 'Gaming', 'screen_size': 15.6, 'resolution': 'Full HD 1920x1080', 'cpu': 'Intel Core i7 7700HQ 2.8GHz', 'ram': '16GB', 'memory': '512GB SSD', 'gpu': 'Nvidia GeForce GTX 1050', 'op': 'Windows 10', 'weight': '2.56kg', 'price': 1249.26}, {'index': 151, 'company': 'Dell', 'product': 'Inspiron 7567', 'type': 'Gaming', 'screen_size': 15.6, 'resolution': 'Full HD 1920x1080', 'cpu': 'Intel Core i7 7700HQ 2.8GHz', 'ram': '8GB', 'memory': '1.0TB Hybrid', 'gpu': 'Nvidia GeForce GTX 1050', 'op': 'Windows 10', 'weight': '2.62kg', 'price': 899.0}, {'index': 158, 'company': 'Dell', 'product': 'Inspiron 5579', 'type': '2 in 1 Convertible', 'screen_size': 15.6, 'resolution': 'Full HD / Touchscreen 1920x1080', 'cpu': 'Intel Core i7 8550U 1.8GHz', 'ram': '8GB', 'memory': '256GB SSD', 'gpu': 'Intel UHD Graphics 620', 'op': 'Windows 10', 'weight': '1.56kg', 'price': 1049.0}, {'index': 162, 'company': 'Dell', 'product': 'Inspiron 3576', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': 'Full HD 1920x1080', 'cpu': 'Intel Core i5 8250U 1.6GHz', 'ram': '8GB', 'memory': '256GB SSD', 'gpu': 'AMD Radeon 520', 'op': 'Windows 10', 'weight': '2.13kg', 'price': 728.0}, {'index': 167, 'company': 'Dell', 'product': 'Inspiron 5577', 'type': 'Gaming', 'screen_size': 15.6, 'resolution': 'Full HD 1920x1080', 'cpu': 'Intel Core i7 7700HQ 2.8GHz', 'ram': '8GB', 'memory': '128GB SSD +  1TB HDD', 'gpu': 'Nvidia GeForce GTX 1050', 'op': 'Windows 10', 'weight': '2.56kg', 'price': 1060.49}, {'index': 175, 'company': 'Dell', 'product': 'Inspiron 3567', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': '1366x768', 'cpu': 'Intel Core i3 7100U 2.4GHz', 'ram': '8GB', 'memory': '1TB HDD', 'gpu': 'Intel HD Graphics 620', 'op': 'Windows 10', 'weight': '2.3kg', 'price': 459.0}, {'index': 180, 'company': 'Dell', 'product': 'Inspiron 5570', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': 'Full HD 1920x1080', 'cpu': 'Intel Core i7 8550U 1.8GHz', 'ram': '16GB', 'memory': '256GB SSD +  2TB HDD', 'gpu': 'AMD Radeon 530', 'op': 'Linux', 'weight': '2.02kg', 'price': 1049.0}, {'index': 181, 'company': 'Dell', 'product': 'XPS 13', 'type': 'Ultrabook', 'screen_size': 13.3, 'resolution': 'Full HD 1920x1080', 'cpu': 'Intel Core i5 8250U 1.6GHz', 'ram': '8GB', 'memory': '256GB SSD', 'gpu': 'Intel UHD Graphics 620', 'op': 'Windows 10', 'weight': '1.23kg', 'price': 1399.0}, {'index': 185, 'company': 'Dell', 'product': 'Inspiron 7773', 'type': 'Notebook', 'screen_size': 17.3, 'resolution': 'Full HD / Touchscreen 1920x1080', 'cpu': 'Intel Core i7 8550U 1.8GHz', 'ram': '16GB', 'memory': '512GB SSD', 'gpu': 'Nvidia GeForce 150MX', 'op': 'Windows 10', 'weight': '2.77kg', 'price': 1549.0}, {'index': 186, 'company': 'Dell', 'product': 'XPS 15', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': '4K Ultra HD / Touchscreen 3840x2160', 'cpu': 'Intel Core i7 7700HQ 2.8GHz', 'ram': '16GB', 'memory': '512GB SSD', 'gpu': 'Nvidia GeForce GTX 1050', 'op': 'Windows 10', 'weight': '2.06kg', 'price': 2397.0}, {'index': 189, 'company': 'Dell', 'product': 'Inspiron 5770', 'type': 'Notebook', 'screen_size': 17.3, 'resolution': 'Full HD 1920x1080', 'cpu': 'Intel Core i7 8550U 1.8GHz', 'ram': '8GB', 'memory': '128GB SSD +  1TB HDD', 'gpu': 'AMD Radeon 530', 'op': 'Windows 10', 'weight': '2.8kg', 'price': 1085.0}, {'index': 194, 'company': 'Dell', 'product': 'Inspiron 5379', 'type': '2 in 1 Convertible', 'screen_size': 13.3, 'resolution': 'IPS Panel Full HD / Touchscreen 1920x1080', 'cpu': 'Intel Core i7 8550U 1.8GHz', 'ram': '8GB', 'memory': '1TB HDD', 'gpu': 'Intel UHD Graphics 620', 'op': 'Windows 10', 'weight': '1.62kg', 'price': 839.0}, {'index': 200, 'company': 'Dell', 'product': 'Inspiron 7577', 'type': 'Gaming', 'screen_size': 15.6, 'resolution': 'IPS Panel 4K Ultra HD 3840x2160', 'cpu': 'Intel Core i7 7700HQ 2.8GHz', 'ram': '16GB', 'memory': '512GB SSD +  1TB HDD', 'gpu': 'Nvidia GeForce GTX 1060', 'op': 'Windows 10', 'weight': '2.65kg', 'price': 1845.0}, {'index': 204, 'company': 'Dell', 'product': 'Precision 7520', 'type': 'Workstation', 'screen_size': 15.6, 'resolution': '4K Ultra HD 3840x2160', 'cpu': 'Intel Xeon E3-1505M V6 3GHz', 'ram': '16GB', 'memory': '256GB SSD +  1TB HDD', 'gpu': 'Nvidia Quadro M1200', 'op': 'Windows 10', 'weight': '2.8kg', 'price': 3055.0}, {'index': 206, 'company': 'Dell', 'product': 'Inspiron 3567', 'type': 'Notebook', 'screen_size': 15.6, 'resolution': 'Touchscreen 1366x768', 'cpu': 'Intel Core i3 7100U 2.4GHz', 'ram': '6GB', 'memory': '1TB HDD', 'gpu': 'Intel HD Graphics 620', 'op': 'Windows 10', 'weight': '2.3kg', 'price': 439.0}, {'index': 207, 'company': 'Dell', 'product': 'XPS 13', 'type': 'Ultrabook', 'screen_size': 13.3, 'resolution': 'IPS Panel 4K Ultra HD / Touchscreen 3840x2160', 'cpu': 'Intel Core i7 8550U 1.8GHz', 'ram': '8GB', 'memory': '256GB SSD', 'gpu': 'Intel UHD Graphics 620', 'op': 'Windows 10', 'weight': '1.21kg', 'price': 1949.0}, {'index': 208, 'company': 'Dell', 'product': 'XPS 13', 'type': 'Ultrabook', 'screen_size': 13.3, 'resolution': 'Full HD 1920x1080', 'cpu': 'Intel Core i7 8550U 1.8GHz', 'ram': '8GB', 'memory': '256GB SSD', 'gpu': 'Intel UHD Graphics 620', 'op': 'Windows 10', 'weight': '1.2kg', 'price': 1449.0}]

sel = None
sel_cart = None
cart_rec = None


@app.route('/home', methods=['GET', 'POST'])
def home():
    global req
    global rec_list
    global sel
    req = None
    rec_list = None
    req = request.get_json()
    print("req="+str(req))
    if req is not None and req['consent'] == 'yes':
        if sel is None:
            rec_list = laptop_recommendation(req['search'])
        else:
            rec_list = laptop_recommendation(req['search'], sel['data'])
        print(rec_list)
        return req
    elif req is not None and req['consent'] == 'no':
        rec_list = None
        return req
    return render_template('home.html', sel=sel, lap_data1=lap_data1)


# @app.route('/home/results', methods=['GET', 'POST'])
# def results():
#     req = request.get_json()
#     print(req)
#     if req['consent'] == "yes":
#         rec_list = laptop_recommendation(req['search'])
#         #print(rec_list)
#         # print(req)
#         # res = make_response(jsonify({"message": "Recommendation Required"}), 200)
#         # return res
#         return redirect(url_for('tables'))
#
#     else:
#         #res = make_response(jsonify({"message": "Recommendation Not Required"}), 200)
#         return redirect(url_for('tables'))


@app.route('/tables', methods=['GET', 'POST'])
def tables():
    flag = 0
    i = None
    for i, data in enumerate(lap_data1):
        if data['company']+" "+data['product']+" "+data['cpu'] in req['search']:
            flag = 1
            break
    if flag == 0:
        return render_template('tables.html', title='Search', rec_list=rec_list, req=req)
    else:
        print(lap_data1[i])
        return render_template('tables.html', title='Search', rec_list=rec_list, req=req, serc=lap_data1[i])


@app.route('/register', methods=['GET', 'POST'])
def register():
    form = RegistrationForm()
    if form.validate_on_submit():
        flash(f'Account created for {form.username.data}!', 'success')
        return redirect(url_for('home'))
    return render_template('register.html', title='Sign Up', form=form)


@app.route('/login', methods=['GET', 'POST'])
def login():
    form = LoginForm()
    if form.validate_on_submit():
        if form.email.data == 'admin@dell.com' and form.password.data == 'password':
            flash('You have been logged in!', 'success')
            return redirect(url_for('home'))
        else:
            flash('Login Unsuccessful. Please check username and password', 'danger')
    return render_template('login.html', title='Log In', form=form)


# @app.route('/layout')
# def layout():
#     return render_template('layout.html')


# @app.route('/layout1')
# def layout1():
#     return render_template('layout1.html')


@app.route('/otherweb', methods=['GET', 'POST'])
def otherweb():
    global sel
    if sel is None:
        sel = None
    sel = request.get_json()
    print("sel="+str(sel))
    if sel is not None:
        return sel
    return render_template('otherweb.html', title="Other Web", lap_data=lap_data)


@app.route('/laptops', methods=['GET', 'POST'])
def laptops():
    global sel_cart
    if sel_cart is None:
        sel_cart = None
    sel_cart = request.get_json()
    print("sel_cart=" + str(sel_cart))
    if sel_cart is not None:
        return sel_cart
    return render_template('laptops.html', title="Laptops", lap_data1=lap_data1)


@app.route('/cart', methods=['GET', 'POST'])
def cart():
    global sel_cart
    global cart_rec
    if sel_cart is not None:
        details = return_data(sel_cart['data'])
        cart_rec = product_recommendation(sel_cart['data'])
        return render_template('cart.html', title="Cart", details=details, cart_rec=cart_rec)
    return render_template('cart.html', title="Cart")


if __name__ == '__main__':
    app.run(debug=True)